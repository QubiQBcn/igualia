<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!--  Sale Order | Form  -->
<record id="view_order_form_inherit_extra_features" model="ir.ui.view">
    <field name="name">view.order.form.inherit.extra.features</field>
    <field name="model">sale.order</field>
    <field name="inherit_id" ref="sale.view_order_form"/>
    <field name="priority">100</field>
    <field name="arch" type="xml">
        <xpath expr="//sheet/group/group[2]" position="replace">
           <group>
                <field name="validity_date" attrs="{'invisible': [('state', 'in', ['sale', 'done'])]}"/>
                <div class="o_td_label" groups="sales_team.group_sale_salesman" attrs="{'invisible': [('state', 'in', ['sale', 'done', 'cancel'])]}">
                    <label for="date_order" string="Quotation Date"/>
                </div>
                <field name="date_order" nolabel="1" groups="sales_team.group_sale_salesman" attrs="{'invisible': [('state', 'in', ['sale', 'done', 'cancel'])]}"/>
                <div class="o_td_label" attrs="{'invisible': [('state', 'in', ['draft', 'sent'])]}">
                    <label for="date_order" string="Order Date"/>
                </div>
                <field name="date_order" attrs="{'required': [('state', 'in', ['sale', 'done'])], 'invisible': [('state', 'in', ['draft', 'sent'])]}" nolabel="1"/>
                <field name="pricelist_id" groups="sales_team.group_sale_salesman" options="{'no_open':True,'no_create': True}"/>
                <field name="currency_id" invisible="1"/>
                <field name="payment_term_id" options="{'no_open':True,'no_create': True}"/>
            </group>
        </xpath>

        <field name="user_id" position="attributes">
            <attribute name="options">{'no_create': True, 'no_create_edit':True}</attribute>
            <attribute name="domain">['|',('groups_id','in',8),('groups_id','in',11)]</attribute>
        </field>

        <field name="user_id" position="after">
            <field name="agent_id" string="Agent" readonly="1"/>
        </field>

    </field>
</record>


<!--  Sale Order Quotation | Tree  -->
<record id="view_quotation_tree_with_onboarding_extra_features" model="ir.ui.view">
    <field name="name">view.quotation.tree.with.onboarding.extra.features</field>
    <field name="model">sale.order</field>
    <field name="inherit_id" ref="sale.view_quotation_tree"/>
    <field name="priority">100</field>
    <field name="arch" type="xml">

        <xpath expr="//tree" position="inside">
            <field name="order_line" widget="many2many_tags" optional="show"/>
        </xpath>

        <field name="create_date" position="after">
            <field name="date_order"  groups="sales_team.group_sale_salesman"/>
        </field>
        

        <field name="order_line" position="after">
            <field name="agent_id" optional="hide"/>
        </field>

       <field name="expected_date" position="attributes">
            <attribute name="optional">hide</attribute>
        </field>


          <field name="commitment_date" position="attributes">
            <attribute name="optional">hide</attribute>
        </field>
    </field>
</record>

<!--  Sale Order Orders | Tree  -->
<record id="view_order_tree_extra_features" model="ir.ui.view">
    <field name="name">sale.order.tree.features</field>
    <field name="model">sale.order</field>
    <field name="inherit_id" ref="sale.view_order_tree"/>
    <field name="priority">100</field>
    <field name="arch" type="xml">

        <xpath expr="//tree" position="inside">
            <field name="order_line" widget="many2many_tags" optional="show"/>
        </xpath>

       <field name="expected_date" position="attributes">
            <attribute name="optional">hide</attribute>
        </field>

          <field name="commitment_date" position="attributes">
            <attribute name="optional">hide</attribute>
        </field>


    </field>
</record>

<record id="view_sale_order_gruposgp_search" model="ir.ui.view">
    <field name="name">view.sale_order_gruposgp.search</field>
    <field name="model">sale.order</field>
    <field name='inherit_id' ref='sale.view_sales_order_filter'/> 
    <field name="arch" type="xml">
        <xpath expr="//filter[@name='customer']" position="after">
            <filter name="agent_id_groupby" string="Agent"
                context="{'group_by': 'agent_id'}" />
        </xpath> 
    </field>
</record>


<!--  Updating sale.order Actions context in order to manipulate name_get   -->
<record id="sale.action_orders" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_orders_to_invoice" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_orders_upselling" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_quotations_with_onboarding" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_quotations" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_orders_salesteams" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

<record id="sale.action_quotations_salesteams" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>


<record id="sale.action_orders_to_invoice_salesteams" model="ir.actions.act_window">
    <field name="context">{'sale_order_line_custom': 1}</field>
</record>

</odoo>