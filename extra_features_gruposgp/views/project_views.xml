<?xml version="1.0" encoding="utf-8"?>
<odoo>



<record id="extra_features_gruposgp_project_search" model="ir.ui.view">
    <field name="name">extra_features_gruposgp_project.project.filter</field>
    <field name="model">project.project</field>
    <field name="inherit_id" ref="project.view_project_project_filter" />
    <field name="priority">1010</field>
    <field name="arch" type="xml">
        <field name="partner_id" position="after">
            <field name="stage_id"/>
        </field>

        <xpath expr="//filter[@name='Partner']" position="after">
            <filter string="Stage" name="stage" context="{'group_by': 'stage_id'}"/>
        </xpath>

    </field>
</record>

<!--  Project Tree View -->
<record id="extra_features_gruposgp_view_project_custom" model="ir.ui.view">
    <field name="name">extra_features_gruposgp__project.project.tree.custom</field>
    <field name="model">project.project</field>
    <field name="inherit_id" ref="project.view_project"/>
    <field name="priority">1010</field>
    <field name="arch" type="xml">
        <field name="sequence" position="before">
            <button  name="project_project_open_project"   type="object" class="fa fa-search-plus oe_highlight" title="Expand Task" aria-label="Open the Task in order to edit further edit."/>
        </field>

        <field name="name" position="after">
            <field name="type_id" string="Project Type" optional="show"/>
             <field name="stage_id"/>
            <!--    Project Stage Hack for tree vierw        -->
<!--             <field name="stage_color" invisible="1"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 0)]}" class="oe_kanban_color__bg_0 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 1)]}" class="oe_kanban_color__bg_1 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 2)]}" class="oe_kanban_color__bg_2 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 3)]}" class="oe_kanban_color__bg_3 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 4)]}" class="oe_kanban_color__bg_4 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 5)]}" class="oe_kanban_color__bg_5 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 6)]}" class="oe_kanban_color__bg_6 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 7)]}" class="oe_kanban_color__bg_7 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 8)]}" class="oe_kanban_color__bg_8 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 9)]}" class="oe_kanban_color__bg_8 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 10)]}" class="oe_kanban_color__bg_10 oe_badge_tree_view"/>-->
<!--             <field name="stage_id" attrs="{'invisible': [('stage_color', '!=', 11)]}" class="oe_kanban_color__bg_11 oe_badge_tree_view"/>-->
        </field>



    </field>

</record>

    <!--  PROJECT | Form  -->
    <record id="project_project_view_form_inherit_extra_features" model="ir.ui.view">
        <field name="name">project.form.inherit.extra.features</field>
        <field name="model">project.project</field>
        <field name="priority">100</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">

            <xpath expr="//header" position="inside">
                <field name="stage_id" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}"/>
            </xpath>

            <xpath expr="//div[hasclass('oe_title')]" position="replace">
                <div class="oe_title">

                     <h1 class="d-flex flex-row justify-content-between">
                        <field name="name" placeholder="Project Name"/>
                    </h1>
                            <!--  DEPRECATED                  -->
<!--                        <h1 class="d-flex flex-row justify-content-between">-->
<!--                            <field name="name" placeholder="Project Name"/>-->
<!--                            <field name="kanban_state" widget="state_selection" class="ml-auto"/>-->
<!--                            &lt;!&ndash;  NOTE: Required Field for Widget state_selection  &ndash;&gt;-->
<!--                            <field name="legend_normal" invisible="1"/>-->
<!--                            <field name="legend_processed" invisible="1"/>-->
<!--                            <field name="legend_done" invisible="1"/>-->
<!--                            <field name="legend_blocked" invisible="1"/>-->
<!--                        </h1>-->
                        <div name="options_active">
                            <div>
                                <label for="label_tasks" class="oe_inline" string="Name of the tasks :"/>
                                <field name="label_tasks" class="oe_inline oe_input_align"/>
                            </div>
                        </div>

                         <group>
                            <field name="check_list_id" string="Check List" readonly="1"/>
                        </group>
                </div>
            </xpath>

            <xpath expr="//group[@name='misc']" position="inside">
                <group string="Stages">
                    <field name="project_type_ids" string="Stages" widget="many2many_tags" options="{'color_field': 'color'}" />
                </group>


                    <!-- DEPRECATED -->
<!--                 <group string="Project Stage" name="group_project_stage">-->

<!--                     <label for="legend_blocked" string=" " class="o_status o_status_red oe_project_kanban_legend"-->
<!--                        title="Task is blocked. Click to unblock or set as done."-->
<!--                        aria-label="Task is blocked. Click to unblock or set as done." role="img"/>-->
<!--                    <field name="legend_blocked" nolabel="1"/>-->

<!--                     <label for="legend_normal" string=" " class="o_status oe_project_kanban_legend"-->
<!--                                title="Task in progress. Click to block or set as done."-->
<!--                                aria-label="Task in progress. Click to block or set as done." role="img"/>-->
<!--                    <field name="legend_normal" nolabel="1"/>-->

<!--                   <label for="legend_processed" string=" " class="o_status oe_project_kanban_legend o_status_yellow"-->
<!--                                title="Task Processed."-->
<!--                                aria-label="Task Processed. Click to block or set as done." role="img"/>-->
<!--                    <field name="legend_processed" nolabel="1"/>-->

<!--                    <label for="legend_done" string=" " class="o_status o_status_green oe_project_kanban_legend"-->
<!--                        title="This step is done. Click to block or set in progress."-->
<!--                        aria-label="This step is done. Click to block or set in progress." role="img"/>-->
<!--                    <field name="legend_done" nolabel="1"/>-->

<!--                 </group>-->

            </xpath>


            <field name="message_follower_ids" position="replace"/>

            <!-- Chatter -->
            <div class="oe_chatter">
                <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                <field name="activity_ids" widget="mail_activity"/>
                <field name="message_ids" widget="mail_thread"/>
            </div>

        </field>
   </record>

    <!--  PROJECT | Stage Quick Form deprecated  -->
    <record id="project_task_stage_quick_form_extra_features" model="ir.ui.view">
        <field name="name">project.project.view.form.stage.quick_create.extra.features</field>
        <field name="model">project.project</field>
        <field name="arch" type="xml">
            <form>
                <sheet >
                    <div class="text-center">
                        <h2 class="text-secondary">Project Stage</h2><br/>
                        <group  name="group_project_stage" class="w-50">

                             <label for="legend_blocked" string=" " class="o_status o_status_red oe_project_kanban_legend"
                                title="Task is blocked. Click to unblock or set as done."
                                aria-label="Task is blocked. Click to unblock or set as done." role="img"/>
                            <field name="legend_blocked" nolabel="1"/>

                             <label for="legend_normal" string=" " class="o_status oe_project_kanban_legend"
                                        title="Task in progress. Click to block or set as done."
                                        aria-label="Task in progress. Click to block or set as done." role="img"/>
                            <field name="legend_normal" nolabel="1"/>

                            <label for="legend_processed" string=" " class="o_status oe_project_kanban_legend"
                                title="Task Processed."
                                aria-label="Task Processed. Click to block or set as done." role="img"/>
                            <field name="legend_processed" nolabel="1"/>

                            <label for="legend_done" string=" " class="o_status o_status_green oe_project_kanban_legend"
                                title="This step is done. Click to block or set in progress."
                                aria-label="This step is done. Click to block or set in progress." role="img"/>
                            <field name="legend_done" nolabel="1"/>
                        </group>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

     <record id="project_project_stage_quick_form_extra_features" model="ir.ui.view">
        <field name="name">project.project.view.form.stage.quick_create.extra.features</field>
        <field name="model">project.project</field>
        <field name="arch" type="xml">
            <form>
                <sheet >
                    <header>
                      <field name="stage_id" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}"/>
                    </header>
                    <div class="text-center">
                        <group>
                            <field name="project_type_ids" string="Stages" mode="tree" widget="one2many">
                                <tree string="Project Stage" editable="top" edit="1">
                                    <field name="sequence" widget="handle" groups="base.group_no_one"/>
                                    <field name="name"/>
                                    <field name="fold"/>
                                    <field name="description"/>
                                    <field name="color" />
                                </tree>
                            </field>
                        </group>
                    </div>
                </sheet>
            </form>
        </field>
    </record>

    <!--  PROJECT | Stage Quick Form Server Action  -->
    <record  id="action_server_project_project_stage_quick_form" model="ir.actions.server">
        <field name="name">action.server.project.project.stage.quick.form</field>
        <field name="model_id" ref="model_project_project"/>
        <field name="state">code</field>
        <field name="code">
            action = model.sudo().project_stage_quick_form_deliver()
        </field>
    </record>
    <menuitem name="project_stage_server_menu" id="project_stage_server_init" action="action_server_project_project_stage_quick_form"/>

    <!--  PROJECT | Project Kanban  -->
    <record id="project_project_view_project_kanban_inherited_extra_features" model="ir.ui.view">
            <field name="name">project.project.kanban.inherited.extra.features</field>
            <field name="model">project.project</field>
            <field name="inherit_id" ref="project.view_project_kanban"/>
            <field name="priority">100</field>
            <field name="arch" type="xml">

                <field name="is_favorite" position="after">
                    <field name="stage_color"/>
                    <field name="stage_id"/>
                    <field name="project_type_ids"/>
                    <!--       DEPRECATED     -->
<!--    <field name="legend_blocked"/>-->
<!--    <field name="legend_normal"/>-->
<!--    <field name="legend_processed"/>-->
<!--    <field name="legend_done" />-->
                </field>

            <xpath expr="//div[hasclass('o_project_kanban_boxes')]" position="before">
                <div class="project_state_container">
                     <span class="prject_state_wrapper">
                         <t t-if="record.stage_id.value">
                             <field name="project_type_ids" widget="one2many_state_selection"/>
                        </t>
                     </span>
                </div>
            </xpath>



<!--                    Type badge, delete if not used-->
<!--                <xpath expr="//div[hasclass('o_kanban_primary_left')]" position="after">-->
<!--                     <t t-if="record.stage_id.value">-->
<!--                       <span class="o_project__status_banner">-->
<!--                           <span t-attf-class="oe_kanban_color__bg_#{record.stage_color.raw_value} o_project__status_badge badge badge-pill">-->
<!--                               <span t-attf-class="oe_kanban_color__text_#{record.stage_color.raw_value} text-bold"> <t t-esc="record.stage_id.value" /> </span>-->
<!--                           </span>-->
<!--                        </span>-->
<!--                    </t>-->
<!--                   -->
<!--                </xpath>-->

<!--                <xpath expr="//a[@t-if='record.allow_timesheets.raw_value']" position="replace">-->
<!--                    <div style="display:flex;">-->
<!--                        <a t-if="record.allow_timesheets.raw_value" name="action_view_timesheet" type="object" class="o_project_kanban_box o_project_timesheet_box" groups="project.group_project_manager">-->
<!--                            <div>-->
<!--                                <span class="o_label">Overview</span>-->
<!--                            </div>-->
<!--                        </a>-->
<!--                         <t t-if="record.stage_id.value">-->
<!--                           <span class="o_project__status_banner">-->
<!--                               <span t-attf-class="oe_kanban_color__bg_#{record.stage_color.raw_value} o_project__status_badge">-->
<!--                                   <field name="stage_id"/>-->
<!--                               </span>-->
<!--                            </span>-->
<!--                        </t>-->
<!--                    </div>-->
<!--                </xpath>-->

                <xpath expr="//div[hasclass('o_kanban_card_manage_pane') and hasclass('dropdown-menu')]/div[hasclass('o_kanban_manage_reports')]/div[2]" position="after">
                    <div role="menuitem" class="o_right " >
                        <a name="project_stage_quick_form" role="menuitem" type="object" context="{'active_id': active_id}">Edit Project Stages</a>
                        <a name="%(action_server_project_project_stage_quick_form)d" role="menuitem" type="action">Edit Task Stages</a>
                    </div>
                </xpath>
  <!--       DEPRECATED     -->
<!--                <xpath expr="//div[hasclass('o_project_kanban_boxes')]" position="inside">-->
<!--                    <div class="oe_kanban_bottom_right" t-if="!selection_mode">-->
<!--                        <field name="kanban_state" widget="state_selection" groups="base.group_user" />-->
<!--                        &lt;!&ndash;  NOTE: Required Field for Widget state_selection  &ndash;&gt;-->
<!--                        <field name="legend_blocked" invisible="1"/>-->
<!--                        <field name="legend_normal" invisible="1"/>-->
<!--                        <field name="legend_processed" invisible="1"/>-->
<!--                        <field name="legend_done" invisible="1"/>-->
<!--                    </div>-->
<!--                </xpath>-->


            </field>
    </record>

<!-- ================ < Project Task > ================  -->


                <!--  added itundra-->
<record id="view_task_tree2_custom" model="ir.ui.view">
    <field name="name">project.task.tree.custom</field>
    <field name="model">project.task</field>
    <field name="inherit_id" ref="project.view_task_tree2" />
    <field name="priority">1000</field>
    <field name="arch" type="xml">

        <xpath expr="//tree" position="attributes">
          <attribute name="edit">1</attribute>
          <attribute name="multi_edit">1</attribute>
          <attribute name="editable">top</attribute>
        </xpath>

        <xpath expr="//tree" position="attributes">
            <attribute name="editable">top</attribute>
        </xpath>

        <field name="message_needaction" position="before">
            <button  name="project_task_open_task"   type="object" class="fa fa-search-plus oe_highlight" title="Expand Task" aria-label="Open the Task in order to edit further edit."/>
        </field>

        <field name="name" position="after">
            <field name="project_stage_id" string="Project Stage"/>
<!--       DEPRECATED     -->
<!--            <field name="project_kanban_state" widget="state_selection" groups="base.group_user" invisible="context.get('fsm_mode', False)" readonly="1"/>-->
<!--            &lt;!&ndash;  NOTE: Required Field for Widget state_selection  &ndash;&gt;-->
<!--            <field name="project_legend_normal" invisible="1"/>-->
<!--            <field name="project_legend_processed" invisible="1"/>-->
<!--            <field name="project_legend_done" invisible="1"/>-->
<!--            <field name="project_legend_blocked" invisible="1"/>-->
<!--            <field name="check_list_id" string="Checklist"/>-->


        </field>


    </field>
</record>

<record id="project_task_code_form_view_custom" model="ir.ui.view">
    <field name="name">project.task.code.form.custom</field>
    <field name="model">project.task</field>
    <field name="inherit_id" ref="project.view_task_form2" />
    <field name="priority">1000</field>
    <field name="arch" type="xml">

        <xpath expr="//notebook//page[1]" position="before">
            <page name="project_checklist_page1" string="Check List">
                <div class="oe_title">
                    <div>
                        <h3 class="d-flex justify-content-center pt-3 form-title">
                            <field name="check_list_name" nolabel="1"/>
                        </h3>
                    </div>
                 </div>
                <group name="group_main_1">
                    <group name="group_info_1">
                       <field name="check_list_project_id" string="Project" widget="many2many_tags" readonly="1"
                       groups="project.group_project_manager"/>
                        <field name="check_list_company_id" />
                        <field name="check_list_partner_id" string="Contact" />
                        <field name="check_list_title" string="Cargo" />
                    </group>
                    <group col="1" name="group_info_2"></group>

                     <group name="group_info_3">
                         <field name="check_list_phone" string="Telefono Oficina" />
                        <field name="check_list_mobile" string="Telefono Móvil" />
                    </group>
                    <group name="group_info_4">
                        <field name="check_list_street" string="Dirección"/>
                        <field name="check_list_email" string="Email"/>
                     </group>

                    <group col="1" name="group_info_5">
                        <field class="oe_inline" name="check_list_rlt_company" string="¿Dispone la empresa de RLT?" widget="radio"/>
                    </group>
                    <group col="1" name="group_info_6">
                        <field class="oe_inline" name="check_list_rlt_all_working_place" string="¿Está presente la RLT en todos los centros de trabajo?" widget="radio"/>
                    </group>
                </group>

                <group name="check_list_group_equality_data" string="DATOS DE IGUALDAD"  class="enterprise-override">
                    <group>
                        <field name="check_list_sale_agent_id" string="Nombre Agente de Igualdad:"/>
                        <field name="check_list_equality_commission" string="Comisión de Igualdad:"/>
                    </group>
                    <group>
                         <field name="check_list_working_people_number" string="Número de personas trabajadoras:" />
                         <field name="check_list_work_place" string="Centros de trabajo:" />
                         <field name="check_list_agreement" string="Convenio:" />
                    </group>
                </group>
                <notebook>
                    <page string="License Lines" name="license_lines">
                        <field name="check_list_line" widget="section_and_note_one2many"  mode="tree">
                             <tree string="License Order Lines"
                                  decoration-muted="answer == 'no_answer' and not display_type == 'line_section'"
                                  decoration-success="answer == 'yes'"
                                  decoration-danger="answer == 'no'"
                            edit="0" editable="bottom" expand="1" delete="0" multi_edit="1" limit="100"
                            >

                                <field name="display_type" invisible="1"/>
                                <field name="name" widget="section_and_note_text" placeholder="Cuestiones a responder por parte de RRHH"/>
                                <field name="answer" string="SI / NO" placeholder="SI / NO"/>
                                <field name="document_date" string="FECHA DEL DOCUMENTO"  placeholder="Indicar fecha documento o acta"/>
                                <field name="comment" string="COMENTARIOS" placeholder="Comentarios a tener en cuenta a la hora de dar respuesta"/>

                            </tree>
                        </field>
                    </page>
                </notebook>
            </page>
        </xpath>

    </field>
</record>

<!--) but adds tree as the default View -->
<record id="project.action_view_task" model="ir.actions.act_window">
<!--    <field name="view_mode">kanban,tree,form,calendar,pivot,graph,gantt,activity,map</field>-->
    <field name="view_mode">tree,kanban,form,calendar,pivot,graph,activity</field>
</record>

    <!-- Add Gantt and map view (COMING FROM project_enterprise) but adds tree as the default View -->
<record id="project.act_project_project_2_project_task_all" model="ir.actions.act_window">
<!--    <field name="view_mode">tree,kanban,,form,calendar,pivot,graph,activity,gantt,map</field>-->
    <field name="view_mode">tree,kanban,form,calendar,pivot,graph,activity</field>
</record>


<delete model="ir.actions.act_window.view" search="[('act_window_id','=',ref('project.action_view_task')), ('view_mode','=', 'tree')]"/>
<delete model="ir.actions.act_window.view" search="[('act_window_id','=',ref('project.action_view_task')), ('view_mode','=', 'kanban')]"/>

<record id="open_view_task_list_tree" model="ir.actions.act_window.view">
    <field name="sequence" eval="0"/>
    <field name="view_mode">tree</field>
    <field name="act_window_id" ref="project.action_view_task"/>
</record>
<record id="open_view_task_list_kanban" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">kanban</field>
    <field name="act_window_id" ref="project.action_view_task"/>
</record>


</odoo>